{"version":3,"sources":["com/fulcrologic/fulcro/mutations.cljc"],"mappings":";;;;;;;;;;;;;;AAmBA,AACA,AAUG,AAAA;;;;;;;;;;AAAA,AAAA,AAAA,AAAA,AAAA,AAAAA,AAASU;;AAAT,AAAA,AAAAT,AAAA;AAAA,AAAA,AAAAC,AAAA,AAAA,AAAA,AAAA;AAAA,AAAA,AAAAA;AAAA;AAAA,AAAAD;;;AAAA;AAAA,AAAAA,AAAA,AAAA,AAAA;;;;AAAA,AAAA,AAAAE,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA;;;;;AAAA,AAAA,AAAA,AAAA,AAAAF,AAAAG,AAASM;;AAAT,AAAA,AAAAT,AAAA;AAAA,AAAA,AAAA,AAAAA,AAAAA,AAAA,AAAA,AAAAA,AAAA,AAAAI,AAAAD;;;AAAA,AAAA,AAAA,AAAA,AAASM;;AAAT,AAAA,AAAA,AAEYG;AAFZ,AAGI,AAAAC,AAAA;AAAA,AAAA,AAAAA,AAAAA,AAACD,AAAAA,AAAAA;;;AAHL,AAAA,AAAA,AAAA,AAASH,AAIQK;;AAJjB,AAAA,AAAA,AAIYF;AAJZ,AAKI,AAAAG,AAAA,AAAA,AAAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAMJ,AAAIG;;;AALd,AAAA,AAAA,AAASL;AAAT,AAAA,AAAA;;;AAAA,AAAA,AAAA,AAASA;;AAAT,AAAA,AAAA,AAASA;;AAAT,AAAA,AAAA,AAAAJ,AAAAC,AAAAC,AAASE;AAAT,AAAA,AAAAD,AAAAF,AAAA;;;AAAA;;;AAAA,AAASI,AAAUC;AAAnB,AAAA,AAAAF,AAAmBE;;;AAAVF,AAOZ,AAAA;;;;;;;;AAAA,AAAAO,AAAOE;AAAP,AAAA,AAAAD,AAAA,AAAA;AAAA,AAAA,AAAAA;AAAA;AAAA,AAAAC,AAAA,AAAA,AAAA;;;AAAA;AAAA,AAAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA;;;;AAAA,AAAA,AAAAhB,AAAA,AAAA,AAAA,AAAA;;;;;AAAA,AAAA,AAAA,AAAOgB,AAOHC;AAPJ,AASG,AAAA,AAACC,AAA+BD;;;AATnC,AAAA,AAAA,AAAOD,AAUHC,AAAIE;AAVR,AAYG,AAAAC,AAAqCH;AAArCG,AAAA,AAAA,AAAA,AAAA,AAAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAAA,AAAA,AAAA,AAAAC,AAAA,AAAAD,AAAA,AAAA,AAAA,AAAA,AAAAE,AAAAC,AAAAH,AAAAA;AAAA,AAAAI,AAAAJ,AAAA,AAAcK;AAAd,AAAAD,AAAAJ,AAAA,AAAkBM;AAAlB,AAAAF,AAAAJ,AAAA,AAAwBO;AAAxB,AAAAH,AAAAJ,AAAA,AAA+BQ;AACzBC,AAAc,AAAA,AAACC,AAAiBL;AADtC,AAEE,AAAMG;AAAN,AACE,AAACG,AAAML,AAAM,AAAKM;AAAL,AACE,AAAI,AAAAC,AAAe,AAAA,AAAShB;AAAxB,AAAA,AAAAgB,AAAAA,AAACJ,AAAAA,AAAAA;;AACH,AAACK,AAASF,AAAE,AAACG,AAAKP,AAAIT,AAAGQ;;AACzB,AAACS,AAAUJ,AAAEJ,AAAIS,AAAOlB;;;;AAJ3C;;AAKAF;;;AAnBL,AAAA,AAAA,AAAOD;;AAAP,AAqBA;;;;;;;;AAAA,AAAOsB,AAOJrB;AAPH,AASE,AAAAsB,AAA2BtB;AAA3BsB,AAAA,AAAA,AAAA,AAAA,AAAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAAA,AAAA,AAAA,AAAAlB,AAAA,AAAAkB,AAAA,AAAA,AAAA,AAAA,AAAAjB,AAAAC,AAAAgB,AAAAA;AAAA,AAAAf,AAAAe,AAAA,AAAcd;AAAd,AAAAD,AAAAe,AAAA,AAAkBZ;AAAlB,AACE,AAAAa,AAAmC,AAAA,AAACV,AAAiBL;AAArD,AAAA,AAAAe;AAAA,AAAAA,AAAeC;AAAf,AAAA,AAAAD,AACmC,AAAA,AAACV,AAAiBL;AADrD,AAAA,AAAAe;AAAA,AAAAA,AACeX;AADf,AAAA,AAAAW,AAEmC,AAACX,AAAAA,AAAAA,AAAcF,AAAAA;AAFlD,AAAA,AAAAa;AAAA,AAAAA,AAEeE;AAFf,AAAA,AAGE,AAACD,AAAAA,AAAAA,AAAoBxB,AAAAA;;AAHvB;;AAAA;;AAAA;;AAIAA;;AAEJ;;;;;;;;;AAAA,AAAO0B,AAQJ1B;AARH,AAUE,AAAA2B,AAAoC3B;AAApC2B,AAAA,AAAA,AAAA,AAAA,AAAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAAA,AAAA,AAAA,AAAAvB,AAAA,AAAAuB,AAAA,AAAA,AAAA,AAAA,AAAAtB,AAAAC,AAAAqB,AAAAA;AAAA,AAAApB,AAAAoB,AAAA,AAAcnB;AAAd,AAAAD,AAAAoB,AAAA,AAAkBE;AAAlB,AAAAtB,AAAAoB,AAAA,AAA2BjB;AAA3BkB,AACuCC;AADvCD,AAAA,AAAA,AAAA,AAAA,AAAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAAA,AAAA,AAAA,AAAAxB,AAAA,AAAAwB,AAAA,AAAA,AAAA,AAAA,AAAAvB,AAAAC,AAAAsB,AAAAA;AAAA,AAAArB,AAAAqB,AAAA,AACcE;AADd,AAAAvB,AAAAqB,AAAA,AACwBG;AAClBnB,AAAc,AAAA,AAACC,AAAiBL;AAFtC,AAGE,AAAI,AAACI,AAAAA,AAAAA,AAAcF,AAAAA;AACjB,AAAMqB;AAAN,AACE,AAACA,AAAAA,AAAAA,AAAa/B,AAAAA;;AADhB;;AAEA,AAAM8B;AAAN,AACE,AAACA,AAAAA,AAAAA,AAAU9B,AAAAA;;AADb;;;AAEFA;;AAEJ;;;AAAA,AAAOgC,AAEJhC;AAFH,AAIE,AAAAiC,AAAiCjC;AAAjCiC,AAAA,AAAA,AAAA,AAAA,AAAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAAA,AAAA,AAAA,AAAA7B,AAAA,AAAA6B,AAAA,AAAA,AAAA,AAAA,AAAA5B,AAAAC,AAAA2B,AAAAA;AAAA,AAAA1B,AAAA0B,AAAA,AAAczB;AAAd,AAAAD,AAAA0B,AAAA,AAAkBxB;AAAlB,AAAAF,AAAA0B,AAAA,AAAwBvB;AAAxBwB,AACiCxB;AADjCwB,AAAA,AAAA,AAAA,AAAA,AAAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAAA,AAAA,AAAA,AAAA9B,AAAA,AAAA8B,AAAA,AAAA,AAAA,AAAA,AAAA7B,AAAAC,AAAA4B,AAAAA;AAAA,AAAA3B,AAAA2B,AAAA,AACcC;AADd,AAAA5B,AAAA2B,AAAA,AACmBE;AACbxB,AAAc,AAAA,AAACC,AAAiBL;AAChC6B,AAAc,AAACC,AAA8BH;AAHnD,AAIE,AAACI,AAAwB/B,AAAI2B;;AAC7B,AAAA,AAACK,AAAMxC,AAAoBqC;;AAE/B;;;;;;;;;AAAA,AAAOI,AAQJzC;AARH,AAUE,AAAA0C,AAAiC1C;AAAjC0C,AAAA,AAAA,AAAA,AAAA,AAAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAAA,AAAA,AAAA,AAAAtC,AAAA,AAAAsC,AAAA,AAAA,AAAA,AAAA,AAAArC,AAAAC,AAAAoC,AAAAA;AAAA,AAAAnC,AAAAmC,AAAA,AAAclC;AAAd,AAAAD,AAAAmC,AAAA,AAAkBjC;AAAlB,AAAAF,AAAAmC,AAAA,AAAwBhC;AAAxBiC,AACiCjC;AADjCiC,AAAA,AAAA,AAAA,AAAA,AAAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAAA,AAAA,AAAA,AAAAvC,AAAA,AAAAuC,AAAA,AAAA,AAAA,AAAA,AAAAtC,AAAAC,AAAAqC,AAAAA;AAAA,AAAApC,AAAAoC,AAAA,AACcR;AADd,AAAA5B,AAAAoC,AAAA,AACmBP;AACbxB,AAAc,AAAA,AAACC,AAAiBL;AAFtC,AAGE,AAAU,AAACI,AAAAA,AAAAA,AAAcF,AAAAA;AAAzB;AAAA,AACE,AAACI,AAAML,AAAMmC,AAA2BR,AAAYD;;;AACtDnC;;AAEJ;;;;;;;;;;;;;;;;;AAAA,AAAO6C,AAgBJ7C;AAhBH,AAkBMA,AACF,AAAA,AAACC,AACD,AAACwC,AACD,AAACT,AACD,AAACX,AACD,AAACK;;AAEL,AAAA,AAAMoB,AAAuBC;AAA7B,AAAmC,AAACC,AAAE1D,AAAS,AAAC2D,AAAKF;;AAErD;;;;AAAA,AAAMG,AAGHC;AAHH,AAIE,AAAI,AAACL,AAAsBK;AACzB,AAACC,AAAM,AAACD,AAAAA,AAAAA;;AACRA;;;AAEJ,AAAA,AAAAE,AAAAC,AAAAC,AAAAC,AAAAC;AAAA;AAAA,AAAA,AAAA,AAAAC,AAAA,AAAAC,AAAA,AAAUQ;AAAVP,AAAA,AAAAD,AAAA;AAAAE,AAAA,AAAAF,AAAA;AAAAG,AAAA,AAAAH,AAAA;AAAAI,AAAA,AAAAxD,AAAA,AAAA,AAAA,AAAAyD,AAAA;AAAA,AAAA,AAAAA,AAAAA,AAAAA;;AAAA,AAAA,AAAAC,AAAA,AAAAC,AAAA,AAAA,AAAiB,AAAKlE;AAAL,AAAU,AAAA,AAAA,AAAA,AAAIA;AAA/B,AAAA+D,AAAAL,AAAAE,AAAAC,AAAAC;;;AAaG,AAAA;;;;;;;AAAAM,AAAA,AAAA7E,AAAA,AAAA;;AAAA,AAAA4E,AAAA,AAAA,AAAA,AAAAE;AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAAA,AAMGK;AANH,AAAA,AAAA,AAAA,AAAAJ;AAAA,AAAA,AAAAC,AAAAD;AAAAC,AAAA,AAAA,AAAA,AAAA,AAAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAAA,AAAA,AAAA,AAAAnE,AAAA,AAAAmE,AAAA,AAAA,AAAA,AAAA,AAAAlE,AAAAC,AAAAiE,AAAAA;AAAA,AAAAhE,AAAAgE,AAAA,AAOmB9D;AAPnB,AAAAF,AAAAgE,AAAA,AAOyB5D;AAPzB,AAQI,AAAM,AAAA,AAAMA;AAAZ,AAAiB,AAAAgE,AAAAC,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAAC,AAAA;AAAA,AAAA,AAAA;AAAA,AAAA,AAAA;;AAAjB;;AACA,AAAC/D,AAAML,AAAMqE,AAAUnE,AAAI,AAAKoE;AAAL,AAAS,AAACC,AAAMD,AAAGL;;;AATlD;AAAA,AAAA,AAAA1E;AAAA,AAAA,AAAAwE,AAAA,AAAA3D,AAAA,AAAA,AAAAb,AAAA;AAAA,AAAA,AAAAwE;AAAA,AAAA,AAAAC,AAAAD;AAAA,AAAA,AAAAC,AAAAA,AAAAzE,AAAAyE,AAAAzE;;AAAA;;;;AAYA,AAAA;;;;AAAAiF,AAAA,AAAA1F,AAAA,AAAA;;AAAA,AAAA4E,AAAA,AAAA,AAAA,AAAAE;AAAA,AAAA,AAAAa,AAAA,AAAA,AAAA,AAAA,AAAAb;AAAAa,AAAA,AAAA,AAAA,AAAA,AAAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAAA,AAAA,AAAA,AAAA9E,AAAA,AAAA8E,AAAA,AAAA,AAAA,AAAA,AAAA7E,AAAAC,AAAA4E,AAAAA;AAAA,AAAA3E,AAAA2E,AAAA,AAGWG;AAHX,AAAA,AAAA,AAAA,AAAAF;AAAA,AAAA,AAAAC,AAAAD;AAAAC,AAAA,AAAA,AAAA,AAAA,AAAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAAA,AAAA,AAAA,AAAAhF,AAAA,AAAAgF,AAAA,AAAA,AAAA,AAAA,AAAA/E,AAAAC,AAAA8E,AAAAA;AAAA,AAAA7E,AAAA6E,AAAA,AAImB3E;AAJnB,AAAAF,AAAA6E,AAAA,AAIyBzE;AAJzB,AAKI,AAAM,AAAA,AAAMA;AAAZ,AAAiB,AAAAgE,AAAAC,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAAC,AAAA;AAAA,AAAA,AAAA;AAAA,AAAA,AAAA;;AAAjB;;AACA,AAAC/D,AAAML,AAAMqE,AAAU,AAAC5D,AAAKP,AAAI0E,AAAOC;;AAN5C;AAAA,AAAA,AAAAtF;AAAA,AAAA,AAAAwE,AAAA,AAAA3D,AAAA,AAAA,AAAAb,AAAA;AAAA,AAAA,AAAAwE;AAAA,AAAA,AAAAC,AAAAD;AAAA,AAAA,AAAAC,AAAAA,AAAAzE,AAAAyE,AAAAzE;;AAAA;;;;AAQH,AAAAmE,AAAA,AAAA,AAAAoB;AAAA,AAAA,AAAAC,AAAAD;AAAAC,AAAA,AAAA,AAAA,AAAA,AAAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAAA,AAAA,AAAA,AAAApF,AAAA,AAAAoF,AAAA,AAAA,AAAA,AAAA,AAAAnF,AAAAC,AAAAkF,AAAAA;AAAA,AAAAjF,AAAAiF,AAAA,AAAoCC;AAApC,AACE,AAAAd,AAAAC,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAAC,AAAA;AAAA,AAAA,AAAA,AAAyF,AAAA,AAAMY;AAA/F,AAAA,AAAA;;AAEF;;;;AAAA,AAAMC,AAGHC,AAAKN;AAHR,AAIE,AAAA,AAAAO,AAAA,AAAAC,AAAA,AAAAC,AAAA,AAAAC,AAAA,AAAAnG,AAAA,AAAA,AAAAiG,AAAA,AAAAC,AAAA,AAAAC,AAAA,AAAAnG,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAAA,AAAA,AAAA,AAAAS,AAAA2F,AAAA,AAAAH,AAAA,AAAAC,AAAA,AAAAC,AAAA,AAAAnG,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAACqG,AAAeN,AAAwBN;;AAE1C;;;;;AAAA,AAAMa,AAIHC,AAAUd,AAAMe;AAJnB,AAKE,AAAA,AAAAR,AAAA,AAAAC,AAAA,AAAAC,AAAA,AAAAC,AAAA,AAAAnG,AAAA,AAAA,AAAAiG,AAAA,AAAAC,AAAA,AAAAC,AAAA,AAAAnG,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAACqG,AAAeE,AAAyBd,AAAMe;;AAG9C;;;;AAAA,AAAOC,AAGJC;AAHH,AAIE,AAAMC,AAAG,AAACC,AAAYF;AAAtB,AACE,AAAI,AAACG,AAASF;AAAd;;AAAoBA;;;AAI3B,AAAA;;;;;;AAAA,AAAA1G,AAAMkH;AAAN,AAAA,AAAAL,AAAA;AAAA,AAAA,AAAAC,AAAA,AAAA;AAAA,AAAA,AAAAC,AAAA;;AAAA,AAAA,AAAA,AAAAA,AAAAD;AAAA,AAAA,AAAAD,AAAA,AAAA,AAAAE;;AAAA,AAAA,AAAAA,AAAA;;;;AAAA;;;;AAAA,AAAAC,AAAA,AAAA,AAAA,AAAA,AAAAH,AAAA,AAAA,AAAAI,AAAA,AAAAJ,AAAA,AAAA,AAAA,AAAA;AAAA,AAAA,AAAAK,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAAF;;;AAAA,AAAA,AAAA,AAAA,AAAAG,AAAMD,AAKHZ,AAAUd;AALb,AAAA,AAAA4B,AAAAD;AAAAC,AAAA,AAAA,AAAA,AAAA,AAAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAAA,AAAA,AAAA,AAAA7G,AAAA,AAAA6G,AAAA,AAAA,AAAA,AAAA,AAAA5G,AAAAC,AAAA2G,AAAAA;AAAA,AAAA1G,AAAA0G,AAAA,AAK6BM;AAL7B,AAAAhH,AAAA0G,AAAA,AAKmCb;AALnC,AAME,AAAQ,AAAAoB,AAAK,AAAAC,AAAIF;AAAJ,AAAA,AAAAE;AAAAA;;AAAUrB;;;AAAf,AAAA,AAAAoB;AAAsB,AAAClC,AAAI,AAAAkC,AAAKD;AAAL,AAAA,AAAAC;AAAWpB;;AAAXoB;;;;AAA3BA;;;AAAR;AAAA,AAAA,AAAA,AAAAzI,AAAA,AAAA,AAAA,AAAA,AAAA;;;AACA,AAAMqH,AAAM,AAACC,AAAe,AAAIkB,AAAM,AAACG,AAAiBH,AAAOnB;AAA/D,AACE,AAACF,AAAWC,AAAUd,AAAMe;;;AARhC,AAAA,AAAA,AAAMW;;AAAN;AAAA,AAAA,AAAA,AAAAG,AAAMH;AAAN,AAAA,AAAAI,AAAA,AAAA/D,AAAA8D;AAAAA,AAAA,AAAAE,AAAAF;AAAAG,AAAA,AAAAjE,AAAA8D;AAAAA,AAAA,AAAAE,AAAAF;AAAA,AAAA,AAAAI,AAAA;AAAA,AAAA,AAAAA,AAAAH,AAAAE,AAAAH;;;AAAA,AAWG,AAAA,AAAOS,AAAerB;AAAtB,AACE,AAAMC,AAAG,AAACqB,AAActB;AAAxB,AACE,AAAI,AAACG,AAASF;AAAd;;AAAoBA;;;AAI3B,AAAA;;;;;;AAAA,AAAA1G,AAAMgI;AAAN,AAAA,AAAAnB,AAAA;AAAA,AAAA,AAAAC,AAAA,AAAA;AAAA,AAAA,AAAAC,AAAA;;AAAA,AAAA,AAAA,AAAAA,AAAAD;AAAA,AAAA,AAAAD,AAAA,AAAA,AAAAE;;AAAA,AAAA,AAAAA,AAAA;;;;AAAA;;;;AAAA,AAAAC,AAAA,AAAA,AAAA,AAAA,AAAAH,AAAA,AAAA,AAAAI,AAAA,AAAAJ,AAAA,AAAA,AAAA,AAAA;AAAA,AAAA,AAAAmB,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAAhB;;;AAAA,AAAA,AAAA,AAAA,AAAAiB,AAAMD,AAKH1B,AAAUd;AALb,AAAA,AAAA0C,AAAAD;AAAAC,AAAA,AAAA,AAAA,AAAA,AAAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAAA,AAAA,AAAA,AAAA3H,AAAA,AAAA2H,AAAA,AAAA,AAAA,AAAA,AAAA1H,AAAAC,AAAAyH,AAAAA;AAAA,AAAAxH,AAAAwH,AAAA,AAK6BR;AAL7B,AAAAhH,AAAAwH,AAAA,AAKmC3B;AALnC,AAME,AAAQ,AAAAoB,AAAK,AAAAC,AAAIF;AAAJ,AAAA,AAAAE;AAAAA;;AAAUrB;;;AAAf,AAAA,AAAAoB;AAAsB,AAAClC,AAAI,AAAAkC,AAAKD;AAAL,AAAA,AAAAC;AAAWpB;;AAAXoB;;;;AAA3BA;;;AAAR;AAAA,AAAA,AAAA,AAAAzI,AAAA,AAAA,AAAA,AAAA,AAAA;;;AACA,AAAMqH,AAAM,AAACuB,AAAc,AAAIJ,AAAM,AAACG,AAAiBH,AAAOnB;AAA9D,AACE,AAACF,AAAWC,AAAUd,AAAMe;;;AARhC,AAAA,AAAA,AAAMyB;;AAAN;AAAA,AAAA,AAAA,AAAAG,AAAMH;AAAN,AAAA,AAAAI,AAAA,AAAA7E,AAAA4E;AAAAA,AAAA,AAAAZ,AAAAY;AAAAE,AAAA,AAAA9E,AAAA4E;AAAAA,AAAA,AAAAZ,AAAAY;AAAA,AAAA,AAAAV,AAAA;AAAA,AAAA,AAAAA,AAAAW,AAAAC,AAAAF;;;AAAA,AAUA,AAAA;;;;;;;;;;;;;;;AAAA,AAAAnI,AAAMsI;AAAN,AAAA,AAAAzB,AAAA;AAAA,AAAA,AAAAC,AAAA,AAAA;AAAA,AAAA,AAAAC,AAAA;;AAAA,AAAA,AAAA,AAAAA,AAAAD;AAAA,AAAA,AAAAD,AAAA,AAAA,AAAAE;;AAAA,AAAA,AAAAA,AAAA;;;;AAAA;;;;AAAA,AAAAC,AAAA,AAAA,AAAA,AAAA,AAAAH,AAAA,AAAA,AAAAI,AAAA,AAAAJ,AAAA,AAAA,AAAA,AAAA;AAAA,AAAA,AAAAyB,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAAtB;;;AAAA,AAAA,AAAA,AAAA,AAAAuB,AAAMD,AAcHhC,AAAUd;AAdb,AAAA,AAAAgD,AAAAD;AAAAC,AAAA,AAAA,AAAA,AAAA,AAAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAAA,AAAA,AAAA,AAAAjI,AAAA,AAAAiI,AAAA,AAAA,AAAA,AAAA,AAAAhI,AAAAC,AAAA+H,AAAAA;AAAA,AAAA9H,AAAA8H,AAAA,AAc6Bd;AAd7B,AAAAhH,AAAA8H,AAAA,AAcmCjC;AAdnC,AAeE,AAAQ,AAAAoB,AAAK,AAAAC,AAAIF;AAAJ,AAAA,AAAAE;AAAAA;;AAAUrB;;;AAAf,AAAA,AAAAoB;AAAsB,AAAClC,AAAI,AAAAkC,AAAKD;AAAL,AAAA,AAAAC;AAAWpB;;AAAXoB;;;;AAA3BA;;;AAAR;AAAA,AAAA,AAAA,AAAAzI,AAAA,AAAA,AAAA,AAAA,AAAA;;;AACA,AAAMqH,AAAM,AAAImB,AAAM,AAACG,AAAiBH,AAAOnB;AAA/C,AACE,AAACF,AAAWC,AAAUd,AAAMe;;;AAjBhC,AAAA,AAAA,AAAM+B;;AAAN;AAAA,AAAA,AAAA,AAAAG,AAAMH;AAAN,AAAA,AAAAI,AAAA,AAAAnF,AAAAkF;AAAAA,AAAA,AAAAlB,AAAAkB;AAAAE,AAAA,AAAApF,AAAAkF;AAAAA,AAAA,AAAAlB,AAAAkB;AAAA,AAAA,AAAAhB,AAAA;AAAA,AAAA,AAAAA,AAAAiB,AAAAC,AAAAF;;;AAAA,AAmBA;;;;;;;;;AAAA,AAAMG,AAQHzI,AAAI0I;AARP,AASE,AAAMA,AAAM,AAAI,AAAI,AAAAC,AAAUD,AAAO,AAAAE,AAASF,AAChC,AAACG,AAAyBH,AAC1BA;AAFd,AAGE,AAAAI,AAA0B9I;AAA1B8I,AAAA,AAAA,AAAA,AAAA,AAAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAAA,AAAA,AAAA,AAAA1I,AAAA,AAAA0I,AAAA,AAAA,AAAA,AAAA,AAAAzI,AAAAC,AAAAwI,AAAAA;AAAA,AAAAvI,AAAAuI,AAAA,AAAcrI;AAAd,AAAAF,AAAAuI,AAAA,AAAoBrD;AAApBsD,AACiCtD;AADjCsD,AAAA,AAAA,AAAA,AAAA,AAAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAAA,AAAA,AAAA,AAAA3I,AAAA,AAAA2I,AAAA,AAAA,AAAA,AAAA,AAAA1I,AAAAC,AAAAyI,AAAAA;AAAA,AAAAxI,AAAAwI,AAAA,AACcC;AADd,AAAAzI,AAAAwI,AAAA,AACkBrE;AADlB,AAAAnE,AAAAwI,AAAA,AACyBE;AADzB,AAEE,AAAMC,AAAc,AAAAC,AAAQ,AAAA,AAAAC,AAACC,AAAeX,AAAOjI;AAA/B,AAAA,AACEwI;AAAM,AAAAE,AAAA,AAAAG,AAACC;AAAD,AAAY,AAAAD,AAACtE,AAAM,AAACwE,AAAKP;;;AADjCE;;;AAApB,AAEE,AAAA,AAAC3G,AAAMxC,AAAS,AAAA,AAAA,AAACyJ,AAAkB,AAAA7J,AAAA,AAAA,AAAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAMoJ,AAAItE,AAAQwE;;AAE7D;;;;;;;;;;AAAA,AAAAQ,AAAME,AASmBC;AATzB,AAAA,AAAAF,AAAAD;AAAAC,AAAA,AAAA,AAAA,AAAA,AAAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAAA,AAAA,AAAA,AAAAvJ,AAAA,AAAAuJ,AAAA,AAAA,AAAA,AAAA,AAAAtJ,AAAAC,AAAAqJ,AAAAA;AAAAA,AASoB3J;AATpB,AAAAO,AAAAoJ,AAAA,AASWlE;AATX,AAUE,AAAAqE,AAAiCrE;AAAjCqE,AAAA,AAAA,AAAA,AAAA,AAAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAAA,AAAA,AAAA,AAAA1J,AAAA,AAAA0J,AAAA,AAAA,AAAA,AAAA,AAAAzJ,AAAAC,AAAAwJ,AAAAA;AAAA,AAAAvJ,AAAAuJ,AAAA,AAAcd;AAAd,AAAAzI,AAAAuJ,AAAA,AAAkBpF;AAAlB,AAAAnE,AAAAuJ,AAAA,AAAyBb;AACnBc,AAAe,AAAId,AACF,AAAA,AAACM,AAAUN,AAAMe,AAAyBH,AAC1C,AAAA,AAAA,AAAA,AAAA,AAACI,AAAmCJ;AAH3D,AAIE,AAAA,AAACrH,AAAMxC,AAAS,AAAA,AAAA,AAACyJ,AAAkB,AAAA7J,AAAA,AAAA,AAAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAMoJ,AAAItE,AAAQqF;;AAEzD;;;;;;;;;AAAA,AAAMG,AAQHlK,AAAI0E;AARP,AASE,AAAA,AAAA,AAAA,AAACzD,AAASjB,AAAmB0E;;AAE/B;;;;;AAAA,AAAOyF,AAIJnK,AAAIoK;AAJP,AAME,AAAA,AAAA,AAAA,AAAA,AAACnJ,AAASjB,AAAgFoK;;AAE5F,AAAA,AAAOC,AACJrK,AAAIsK;AADP,AAAA;AAIE,AAAA,AAAA,AAAA,AAACC,AAAOvK,AAASgK,AAAWM,AAA8BA","names":["unused__10611__auto__","self__","G__57839","js/Error","args57838","cljs.core/aclone","this__4363__auto__","writer__4364__auto__","opt__4365__auto__","cljs.core/-write","com.fulcrologic.fulcro.mutations/Mutation","com.fulcrologic.fulcro.mutations/->Mutation","sym","this","G__57842","args","cljs.core/List","var_args","G__57848","com.fulcrologic.fulcro.mutations/update-errors-on-ui-component!","env","com.fulcrologic.fulcro.mutations.update_errors_on_ui_component_BANG_","k","map__57849","cljs.core/PROTOCOL_SENTINEL","cljs.core.apply","cljs.core/hash-map","cljs.core.get","app","state","result","ref","remote-error?","com.fulcrologic.fulcro.algorithms.lookup/app-algorithm","cljs.core.swap_BANG_","s","G__57851","cljs.core/assoc-in","cljs.core.conj","cljs.core.update_in","cljs.core/dissoc","com.fulcrologic.fulcro.mutations/trigger-global-error-action!","map__57856","b2__47199__auto__","global-error-action","_","com.fulcrologic.fulcro.mutations/dispatch-ok-error-actions!","map__57870","map__57871","dispatch","ok-action","error-action","com.fulcrologic.fulcro.mutations/rewrite-tempids!","map__57874","map__57875","body","transaction","rid->tid","com.fulcrologic.fulcro.algorithms.tempid/result->tempid->realid","com.fulcrologic.fulcro.algorithms.tempid/resolve-tempids!","cljs.core.assoc","com.fulcrologic.fulcro.mutations/integrate-mutation-return-value!","map__57884","map__57885","com.fulcrologic.fulcro.algorithms.merge/merge-mutation-joins","com.fulcrologic.fulcro.mutations/default-result-action!","com.fulcrologic.fulcro.mutations/mutation-declaration?","expr","cljs.core._EQ_","cljs.core/type","com.fulcrologic.fulcro.mutations/mutation-symbol","mutation","cljs.core/first","js/com","js/com.fulcrologic","js/com.fulcrologic.fulcro","js/com.fulcrologic.fulcro.mutations","js/com.fulcrologic.fulcro.mutations.mutate","method-table__4613__auto__","cljs.core.atom","prefer-table__4614__auto__","method-cache__4615__auto__","cached-hierarchy__4616__auto__","hierarchy__4617__auto__","fexpr__57897","cljs.core/MultiFn","cljs.core.symbol","com.fulcrologic.fulcro.mutations/mutate","com.fulcrologic.fulcro.mutations/set-props","fulcro-mutation-env-symbol","p__57907","map__57910","temp__5735__auto__","default-action","params","taoensso.timbre._log_BANG_","taoensso.timbre/*config*","cljs.core/Delay","cljs.core/update-in","st","cljs.core.merge","com.fulcrologic.fulcro.mutations/toggle","map__57918","p__57920","map__57921","field","cljs.core/not","p__57928","map__57929","ast","com.fulcrologic.fulcro.mutations/toggle!","comp","cljs.core/vec","cljs.core.sequence","cljs.core/seq","cljs.core.concat","cljs.core/array-map","com.fulcrologic.fulcro.components.transact_BANG_","com.fulcrologic.fulcro.mutations/set-value!","component","value","com.fulcrologic.fulcro.mutations/ensure-integer","v","rv","js/parseInt","js/isNaN","args__4736__auto__","len__4730__auto__","i__4731__auto__","argseq__4737__auto__","cljs.core/IndexedSeq","com.fulcrologic.fulcro.mutations/set-integer!","p__57947","map__57948","seq57944","G__57945","cljs.core/next","G__57946","self__4717__auto__","event","and__4109__auto__","or__4120__auto__","com.fulcrologic.fulcro.dom.events/target-value","com.fulcrologic.fulcro.mutations/ensure-double","js/parseFloat","com.fulcrologic.fulcro.mutations/set-double!","p__57963","map__57964","seq57960","G__57961","G__57962","com.fulcrologic.fulcro.mutations/set-string!","p__57975","map__57976","seq57972","G__57973","G__57974","com.fulcrologic.fulcro.mutations/returning","class","cljs.core/Keyword","cljs.core/Symbol","com.fulcrologic.fulcro.components/registry-key->class","map__57991","map__57992","key","query","updated-query","G__58022","cljs.core/deref","com.fulcrologic.fulcro.components.get_query","p1__57990#","cljs.core.vary_meta","cljs.core/meta","edn-query-language.core/query->ast1","p__58054","map__58055","com.fulcrologic.fulcro.mutations/with-target","target","map__58057","targeted-query","cljs.core/assoc","cljs.core/with-meta","com.fulcrologic.fulcro.mutations/with-params","com.fulcrologic.fulcro.mutations/with-response-type","response-type","com.fulcrologic.fulcro.mutations/with-server-side-mutation","mutation-symbol","cljs.core.update"],"sourcesContent":["(ns com.fulcrologic.fulcro.mutations\n  #?(:cljs (:require-macros com.fulcrologic.fulcro.mutations))\n  (:require\n    #?(:clj [cljs.analyzer :as ana])\n    [com.fulcrologic.fulcro.components :as comp]\n    [com.fulcrologic.fulcro.dom.events :as evt]\n    [com.fulcrologic.guardrails.core :refer [>def >defn =>]]\n    [edn-query-language.core :as eql]\n    [taoensso.timbre :as log]\n    [taoensso.encore :as enc]\n    [clojure.spec.alpha :as s]\n    [com.fulcrologic.fulcro.algorithms.data-targeting :as targeting]\n    [com.fulcrologic.fulcro.algorithms.merge :as merge]\n    [com.fulcrologic.fulcro.algorithms.lookup :as ah]\n    [com.fulcrologic.fulcro.algorithms.tempid :as tempid]\n    [clojure.string :as str])\n  #?(:clj\n     (:import (clojure.lang IFn))))\n\n(>def ::env (s/keys :req-un [:com.fulcrologic.fulcro.application/app]))\n(>def ::returning comp/component-class?)\n\n#?(:clj\n   (deftype Mutation [sym]\n     IFn\n     (invoke [this]\n       (this {}))\n     (invoke [this args]\n       (list sym args)))\n   :cljs\n   (deftype Mutation [sym]\n     IFn\n     (-invoke [this]\n       (this {}))\n     (-invoke [this args]\n       (list sym args))))\n\n(>defn update-errors-on-ui-component!\n  \"A handler for mutation network results that will place an error, if detected in env, on the data at `ref`.\n  Errors are placed at `k` (defaults to `::m/mutation-error`).\n\n  Typically used as part of the construction of a global default result handler for mutations.\n\n  Swaps against app state and returns `env`.\"\n  ([env]\n   [::env => ::env]\n   (update-errors-on-ui-component! env ::mutation-error))\n  ([env k]\n   [::env keyword? => ::env]\n   (let [{:keys [app state result ref]} env\n         remote-error? (ah/app-algorithm app :remote-error?)]\n     (when ref\n       (swap! state (fn [s]\n                      (if (remote-error? (:result env))\n                        (assoc-in s (conj ref k) result)\n                        (update-in s ref dissoc k)))))\n     env)))\n\n(>defn trigger-global-error-action!\n  \"When there is a `global-error-action` defined on the application, this function will checks for errors in the given\n  mutation `env`. If any are found then it will call the global error action function with `env`.\n\n  Typically used as part of the construction of a global default result handler for mutations.\n\n  Always returns `env`.\"\n  [env]\n  [::env => ::env]\n  (let [{:keys [app result]} env]\n    (enc/when-let [global-error-action (ah/app-algorithm app :global-error-action)\n                   remote-error?       (ah/app-algorithm app :remote-error?)\n                   _                   (remote-error? result)]\n      (global-error-action env))\n    env))\n\n(>defn dispatch-ok-error-actions!\n  \"Looks for network mutation result in `env`, checks it against the global definition of remote errors.  If there\n  is an error and the mutation has defined an `error-action` section, then it calls it; otherwise, if the mutation\n  has an `ok-action` it calls that.\n\n  Typically used as part of the construction of a global default result handler for mutations.\n\n  Returns env.\"\n  [env]\n  [::env => ::env]\n  (let [{:keys [app dispatch result]} env\n        {:keys [ok-action error-action]} dispatch\n        remote-error? (ah/app-algorithm app :remote-error?)]\n    (if (remote-error? result)\n      (when error-action\n        (error-action env))\n      (when ok-action\n        (ok-action env)))\n    env))\n\n(>defn rewrite-tempids!\n  \"Rewrites tempids in state and places a tempid->realid map into env for further use by the mutation actions.\"\n  [env]\n  [::env => ::env]\n  (let [{:keys [app state result]} env\n        {:keys [body transaction]} result\n        remote-error? (ah/app-algorithm app :remote-error?)\n        rid->tid      (tempid/result->tempid->realid body)]\n    (tempid/resolve-tempids! app body)\n    (assoc env :tempid->realid rid->tid)))\n\n(>defn integrate-mutation-return-value!\n  \"If there is a successful result from the remote mutation in `env` this function will merge it with app state\n  (if there was a mutation join query), and will also rewrite any tempid remaps that were returned\n  in all of the possible locations they might be in both app database and runtime application state (e.g. network queues).\n\n  Typically used as part of the construction of a global default result handler for mutations.\n\n  Returns env.\"\n  [env]\n  [::env => ::env]\n  (let [{:keys [app state result]} env\n        {:keys [body transaction]} result\n        remote-error? (ah/app-algorithm app :remote-error?)]\n    (when-not (remote-error? result)\n      (swap! state merge/merge-mutation-joins transaction body))\n    env))\n\n(>defn default-result-action!\n  \"The default Fulcro result action for `defmutation`, which can be overridden when you create your `app/fulcro-app`.\n\n  This function is the following composition of operations from this same namespace:\n\n```\n  (-> env\n    (update-errors-on-ui-component! ::mutation-error)\n    (integrate-mutation-return-value!)\n    (trigger-global-error-action!)\n    (dispatch-ok-error-actions!))\n```\n\n  This function returns `env`, so it can be used as part of the chain in your own definition of a \\\"default\\\"\n  mutation result action.\n  \"\n  [env]\n  [::env => ::env]\n  (-> env\n    (update-errors-on-ui-component! ::mutation-error)\n    (integrate-mutation-return-value!)\n    (rewrite-tempids!)\n    (trigger-global-error-action!)\n    (dispatch-ok-error-actions!)))\n\n(defn mutation-declaration? [expr] (= Mutation (type expr)))\n\n(defn mutation-symbol\n  \"Return the real symbol (for mutation dispatch) of `mutation`, which can be a symbol (this function is then identity)\n   or a mutation-declaration.\"\n  [mutation]\n  (if (mutation-declaration? mutation)\n    (first (mutation))\n    mutation))\n\n(defmulti mutate (fn [env] (-> env :ast :dispatch-key)))\n\n#?(:clj\n   (defmacro declare-mutation\n     \"Define a quote-free interface for using the given `target-symbol` in mutations.\n     The declared mutation can be used in lieu of the true mutation symbol\n     as a way to prevent circular references while also allowing the shorthand of ns aliasing.\n\n     In IntelliJ, use Resolve-as `def` to get proper IDE integration.\"\n     ([name target-symbol]\n      `(def ~name (->Mutation '~target-symbol)))))\n\n#?(:cljs\n   (com.fulcrologic.fulcro.mutations/defmutation set-props\n     \"\n     mutation: A convenience helper, generally used 'bit twiddle' the data on a particular database table (using the component's ident).\n     Specifically, merge the given `params` into the state of the database object at the component's ident.\n     In general, it is recommended this be used for ui-only properties that have no real use outside of the component.\n     \"\n     [params]\n     (action [{:keys [state ref]}]\n       (when (nil? ref) (log/error \"ui/set-props requires component to have an ident.\"))\n       (swap! state update-in ref (fn [st] (merge st params))))))\n\n#?(:cljs\n   (com.fulcrologic.fulcro.mutations/defmutation toggle\n     \"mutation: A helper method that toggles the true/false nature of a component's state by ident.\n      Use for local UI data only. Use your own mutations for things that have a good abstract meaning. \"\n     [{:keys [field]}]\n     (action [{:keys [state ref]}]\n       (when (nil? ref) (log/error \"ui/toggle requires component to have an ident.\"))\n       (swap! state update-in (conj ref field) not))))\n\n(defmethod mutate :default [{:keys [ast]}]\n  (log/error \"Unknown app state mutation. Have you required the file with your mutations?\" (:key ast)))\n\n(defn toggle!\n  \"Toggle the given boolean `field` on the specified component. It is recommended you use this function only on\n  UI-related data (e.g. form checkbox checked status) and write clear top-level transactions for anything more complicated.\"\n  [comp field]\n  (comp/transact! comp `[(toggle {:field ~field})] {:compressible? true}))\n\n(defn set-value!\n  \"Set a raw value on the given `field` of a `component`. It is recommended you use this function only on\n  UI-related data (e.g. form inputs that are used by the UI, and not persisted data). Changes made via these\n  helpers are compressed in the history.\"\n  [component field value]\n  (comp/transact! component `[(set-props ~{field value})] {:compressible? true}))\n\n#?(:cljs\n   (defn- ensure-integer\n     \"Helper for set-integer!, use that instead. It is recommended you use this function only on UI-related\n     data (e.g. data that is used for display purposes) and write clear top-level transactions for anything else.\"\n     [v]\n     (let [rv (js/parseInt v)]\n       (if (js/isNaN rv) 0 rv)))\n   :clj\n   (defn- ensure-integer [v] (Integer/parseInt v)))\n\n(defn set-integer!\n  \"Set the given integer on the given `field` of a `component`. Allows same parameters as `set-string!`.\n\n   It is recommended you use this function only on UI-related data (e.g. data that is used for display purposes)\n   and write clear top-level transactions for anything else. Calls to this are compressed in history.\"\n  [component field & {:keys [event value]}]\n  (assert (and (or event value) (not (and event value))) \"Supply either :event or :value\")\n  (let [value (ensure-integer (if event (evt/target-value event) value))]\n    (set-value! component field value)))\n\n#?(:cljs\n   (defn- ensure-double [v]\n     (let [rv (js/parseFloat v)]\n       (if (js/isNaN rv) 0 rv)))\n   :clj\n   (defn- ensure-double [v] (Double/parseDouble v)))\n\n(defn set-double!\n  \"Set the given double on the given `field` of a `component`. Allows same parameters as `set-string!`.\n\n   It is recommended you use this function only on UI-related data (e.g. data that is used for display purposes)\n   and write clear top-level transactions for anything else. Calls to this are compressed in history.\"\n  [component field & {:keys [event value]}]\n  (assert (and (or event value) (not (and event value))) \"Supply either :event or :value\")\n  (let [value (ensure-double (if event (evt/target-value event) value))]\n    (set-value! component field value)))\n\n(defn set-string!\n  \"Set a string on the given `field` of a `component`. The string can be literal via named parameter `:value` or\n  can be auto-extracted from a UI event using the named parameter `:event`\n\n  Examples\n\n  ```\n  (set-string! this :ui/name :value \\\"Hello\\\") ; set from literal (or var)\n  (set-string! this :ui/name :event evt) ; extract from UI event target value\n  ```\n\n  It is recommended you use this function only on UI-related\n  data (e.g. data that is used for display purposes) and write clear top-level transactions for anything else.\n  Calls to this are compressed in history.\"\n  [component field & {:keys [event value]}]\n  (assert (and (or event value) (not (and event value))) \"Supply either :event or :value\")\n  (let [value (if event (evt/target-value event) value)]\n    (set-value! component field value)))\n\n(defn returning\n  \"Indicate the the remote operation will return a value of the given component type.\n\n  `env` - The env of the mutation\n  `class` - A component class that represents the return type.  You may supply a fully-qualified symbol instead of the\n  actual class, and this method will look up the class for you (useful to avoid circular references).\n\n  Returns an update `env`, and is a valid return value from mutation remote sections.\"\n  [env class]\n  (let [class (if (or (keyword? class) (symbol? class))\n                (comp/registry-key->class class)\n                class)]\n    (let [{:keys [state ast]} env\n          {:keys [key params query]} ast]\n      (let [updated-query (cond-> (comp/get-query class @state)\n                            query (vary-meta #(merge (meta query) %)))]\n        (assoc env :ast (eql/query->ast1 [{(list key params) updated-query}]))))))\n\n(defn with-target\n  \"Set's a target for the return value from the mutation to be merged into. This can be combined with returning to define\n  a path to insert the new entry.\n\n  `env` - The mutation env (you can thread together `returning` and `with-target`)\n  `target` - A vector path, or any special target defined in `data-targeting` such as `append-to`.\n\n  Returns an updated env (which is a valid return value from remote sections of mutations).\n  \"\n  [{:keys [ast] :as env} target]\n  (let [{:keys [key params query]} ast\n        targeted-query (if query\n                         (vary-meta query assoc ::targeting/target target)\n                         (with-meta '[*] {::targeting/target target}))]\n    (assoc env :ast (eql/query->ast1 [{(list key params) targeted-query}]))))\n\n(defn with-params\n  \"Modify an AST containing a single mutation, changing it's parameters to those given as an argument. Overwrites\n   any existing params of the mutation.\n\n   `env` - the mutation environment\n   `params` - A new map to use as the mutations parameters\n\n   Returns an updated `env`, which can be used as the return value from a remote section of a mutation.\"\n  [env params]\n  (assoc-in env [:ast :params] params))\n\n(>defn with-response-type\n  \"Modify the AST in env so that the request is sent such that an alternate low-level XHRIO response type is used.\n  Only works with HTTP remotes. See goog.net.XhrIO.  Supported response types are :default, :array-buffer,\n  :text, and :document.\"\n  [env response-type]\n  [::env :com.fulcrologic.fulcro.networking.http-remote/response-type => ::env]\n  (assoc-in env [:ast :params :com.fulcrologic.fulcro.networking.http-remote/response-type] response-type))\n\n(>defn with-server-side-mutation\n  [env mutation-symbol]\n  [::env qualified-symbol? => ::env]\n  \"Alter the remote mutation name to be `mutation-symbol` instead of the client-side's mutation name.\"\n  (update env :ast assoc :key mutation-symbol :dispatch-key mutation-symbol))\n\n;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\n;; DEFMUTATION MACRO: This code could live in another ns, but then hot code reload won't work right on the macro itself.\n;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\n\n#?(:clj\n   (s/def ::handler (s/cat\n                      :handler-name symbol?\n                      :handler-args (fn [a] (and (vector? a) (= 1 (count a))))\n                      :handler-body (s/+ (constantly true)))))\n\n#?(:clj\n   (s/def ::mutation-args (s/cat\n                            :sym symbol?\n                            :doc (s/? string?)\n                            :arglist (fn [a] (and (vector? a) (= 1 (count a))))\n                            :sections (s/* (s/or :handler ::handler)))))\n\n#?(:clj\n   (defn defmutation* [macro-env args]\n     (let [conform!       (fn [element spec value]\n                            (when-not (s/valid? spec value)\n                              (throw (ana/error macro-env (str \"Syntax error in \" element \": \" (s/explain-str spec value)))))\n                            (s/conform spec value))\n           {:keys [sym doc arglist sections]} (conform! \"defmutation\" ::mutation-args args)\n           fqsym          (if (namespace sym)\n                            sym\n                            (symbol (name (ns-name *ns*)) (name sym)))\n           handlers       (reduce (fn [acc [_ {:keys [handler-name handler-args handler-body]}]]\n                                    (let [action? (str/ends-with? (str handler-name) \"action\")]\n                                      (into acc\n                                        (if action?\n                                          [(keyword (name handler-name)) `(fn ~handler-name ~handler-args\n                                                                            ~@handler-body\n                                                                            nil)]\n                                          [(keyword (name handler-name)) `(fn ~handler-name ~handler-args ~@handler-body)]))))\n                            []\n                            sections)\n           ks             (into #{} (filter keyword?) handlers)\n           result-action? (contains? ks :result-action)\n           env-symbol     'fulcro-mutation-env-symbol\n           method-map     (if result-action?\n                            `{~(first handlers) ~@(rest handlers)}\n                            `{~(first handlers) ~@(rest handlers)\n                              :result-action    (fn [~'env]\n                                                  (when-let [~'default-action (ah/app-algorithm (:app ~'env) :default-result-action!)]\n                                                    (~'default-action ~'env)))})\n           doc            (or doc \"\")\n           multimethod    `(defmethod com.fulcrologic.fulcro.mutations/mutate '~fqsym [~env-symbol]\n                             (let [~(first arglist) (-> ~env-symbol :ast :params)]\n                               ~method-map))]\n       (if (= fqsym sym)\n         multimethod\n         `(do\n            (def ~(with-meta sym {:doc doc}) (com.fulcrologic.fulcro.mutations/->Mutation '~fqsym))\n            ~multimethod)))))\n\n#?(:clj\n   (defmacro\n     ^{:doc\n       \"Define a Fulcro mutation.\n\n     The given symbol will be prefixed with the namespace of the current namespace, and if you use a simple symbol it\n     will also be def'd into a name that when used as a function will simply resolve to that function call as data:\n\n     ```\n     (defmutation f [p]\n       ...)\n\n     (f {:x 1}) => `(f {:x 1})\n     ```\n\n     This allows mutations to behave as data in transactions without needing quoting.\n\n     Mutations can have any number of handlers. By convention things that contain logic use names that end\n     in `action`.  The remote behavior of a mutation is defined by naming a handler after the remote.\n\n     ```\n     (defmutation boo\n       \\\"docstring\\\" [params-map]\n       (action [env] ...)\n       (my-remote [env] ...)\n       (other-remote [env] ...)\n       (remote [env] ...))\n     ```\n\n     NOTE: Every handler in the defmutation is turned into a lambda, and that lambda will be available in `env` under\n     the key `:handlers`. Thus actions and remotes can cross-call (TODO: Make the macro rewrite cross calls so they\n     can look like fn calls?):\n\n     ```\n     (defmutation boo\n       \\\"docstring\\\" [params-map]\n       (action [env] ...)\n       (ok-action [env] ...)\n       (result-action [env] ((-> env :handlers :ok-action) env)))\n     ```\n\n     This macro normally adds a `:result-action` handler that does normal Fulcro mutation remote result logic unless\n     you supply your own.\n\n     Remotes in Fulcro 3 are also lambdas, and are called with an `env` that contains the state as it exists *after*\n     the `:action` has run in `state`, but also include the 'before action state' as a map in `:state-before-action`.\n\n     IMPORTANT: You can fully-qualify a mutation's symbol when declaring it to force it into a custom namespace,\n     but this is highly discouraged and will require quoting when used in a mutation.\n     \"\n       :arglists\n       '([sym docstring? arglist handlers])} defmutation\n     [& args]\n     (defmutation* &env args)))\n"]}